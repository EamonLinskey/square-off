(this["webpackJsonpreact-client"]=this["webpackJsonpreact-client"]||[]).push([[0],{113:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(54),o=n.n(a),i=n(3),s=n.n(i),u=n(5),l=n(4),p=(n(64),n(20)),d=n(21),f=n(55),j=new(function(){function e(){Object(p.a)(this,e),this.socket=null}return Object(d.a)(e,[{key:"connect",value:function(e){var t=this;return new Promise((function(n,r){if(t.socket=Object(f.io)(e),!t.socket)return r();t.socket.on("connect",(function(){n(t.socket)})),t.socket.on("connect_error",(function(e){console.log("Connection error: ",e),r(e)}))}))}}]),e}()),b={isInRoom:!1,setInRoom:function(){},isPlaying:!1,setIsPlaying:function(){},prompt:null,setPrompt:function(){},user:null,setUser:function(){}},m=c.a.createContext(b),v=new(function(){function e(){Object(p.a)(this,e)}return Object(d.a)(e,[{key:"joinGameRoom",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n,r){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,c){console.log("user:",r),alert("a"),t.emit("join_game",{roomId:n,firstName:"jimmy",photoUrl:"afd"}),t.on("room_joined",(function(){return e(!0)})),t.on("room_join_error",(function(e){var t=e.error;return c(t)}))})));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"startGame",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.emit("start_game",n);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onTimeLeftUpdate",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on("time_left",(function(e){var t=e.timeLeft;n(t)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onGameStart",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on("game_has_started",n);case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onPlayerJoin",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on("player_has_joined",(function(e){var t=e.players_map;return n(t)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"requestCompletePlayerMap",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.emit("needs_complete_player_map"),t.on("complete_player_map",(function(e){var t=e.players_map;return n(t)}));case 2:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onPromptUpdate",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on("new_prompt",(function(e){var t=e.prompt;return n(t)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"submitAnswer",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.emit("answer_submission",{answer:n});case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendMouseMove",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.emit("mouse_move",{position:n});case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onMouseMove",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on("updated_player_positions",(function(e){var t=e.players_map;return n(t)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onGameEnd",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on("game_end",(function(){return n()}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onGameWin",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on("you won",(function(){return n()}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onGameLoss",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on("you lost",(function(){return n()}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"onScoreUpdate",value:function(){var e=Object(u.a)(s.a.mark((function e(t,n){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.on("updated_score",(function(e){var t=e.scoreboard;return n(t)}));case 1:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()}]),e}()),h=n(1);function O(){var e=Object(r.useState)(""),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(!1),o=Object(l.a)(a,2),i=o[0],p=o[1],d=Object(r.useContext)(m),f=d.setInRoom,b=(d.isInRoom,Object(r.useContext)(m).user),O=function(){var e=Object(u.a)(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=j.socket,n&&""!==n.trim()&&r){e.next=4;break}return e.abrupt("return");case 4:return p(!0),e.next=7,v.joinGameRoom(r,n,b).catch((function(e){alert(e)}));case 7:e.sent&&f(!0),p(!1);case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(h.jsxs)("form",{className:"login account-panel",onSubmit:O,children:[Object(h.jsx)("h1",{className:"banner-header",children:"Welcome"}),Object(h.jsx)("h2",{children:"Join a room"}),Object(h.jsx)("input",{placeholder:"Room ID",value:n,onChange:function(e){var t=e.target.value;c(t)}}),Object(h.jsx)("div",{id:"button-background-3d",children:Object(h.jsx)("button",{type:"submit",id:"login",className:"fun-orange-button",disabled:i,children:"Join!"})})]})}var x=n(58);function k(e){var t,n=Object(r.useState)(null),c=Object(l.a)(n,2),a=c[0],o=c[1],i=Object(r.useContext)(m).isPlaying;return Object(h.jsxs)("button",{className:"square","data-grade":a,onClick:function(){var t;if(i){var n=(null===(t=e.prompt)||void 0===t?void 0:t.toString())===[e.col,e.row].toString()?"correct":"incorrect";e.onSubmitAnswer([e.col,e.row]),o(n),setTimeout((function(){o(null)}),250)}},children:[Object(h.jsx)("div",{className:"row-label",children:e.row}),Object(h.jsx)("div",{className:"col-label",children:(t=e.col,["a","b","c","d","e","f","g","h"][t-1])})]})}var y=function(e){var t=Object(r.useState)([0,0]),n=Object(l.a)(t,2),c=(n[0],n[1],Object(r.useState)({})),a=Object(l.a)(c,2),o=a[0],i=a[1],s=Object(r.useContext)(m),u=s.prompt,p=(s.setPrompt,Object(r.useRef)(null)),d=[1,2,3,4,5,6,7,8];return"white"==e.perspective&&(d=d.reverse()),Object(r.useEffect)((function(){v.onMouseMove(j.socket,(function(e){i((function(t){var n=Object(x.a)({},t);for(var r in n){var c,a;n[r].x=null===(c=e[r])||void 0===c?void 0:c.x,n[r].y=null===(a=e[r])||void 0===a?void 0:a.y}return n}))})),v.onPlayerJoin(j.socket,(function(e){i(e)})),v.requestCompletePlayerMap(j.socket,(function(e){i(e)}))}),[]),Object(h.jsxs)("div",{id:"board",ref:p,onMouseMove:function(e){var t=p.current;if(t){var n=t.getBoundingClientRect(),r=100*(e.clientX-n.left)/n.width,c=100*(e.clientY-n.top)/n.height;v.sendMouseMove(j.socket,[r,c])}else alert("no board")},children:[d.map((function(t){return function(t){var n=[1,2,3,4,5,6,7,8];return"black"==e.perspective&&(n=n.reverse()),Object(h.jsx)("div",{className:"row",children:n.map((function(n){return Object(h.jsx)(k,{row:t,col:n,onSubmitAnswer:e.onSubmitAnswer,prompt:u},n)}))},t)}(t)})),function(e){var t=[];for(var n in e)if(n!=j.socket.id){var r=e[n];t.push(Object(h.jsx)("div",{id:"rival",style:{left:"calc(".concat(r.x,"% - 35px)"),top:"calc(".concat(r.y,"% - 35px)")},children:Object(h.jsx)("img",{src:r.photoUrl||"https://pbs.twimg.com/profile_images/1354861288690749448/FztA7cjH_400x400.jpg"})}))}return t}(o)]})};function g(){var e=Object(r.useState)({}),t=Object(l.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){v.onScoreUpdate(j.socket,(function(e){console.log(e),c(e)})),v.onGameEnd(j.socket,(function(){n={}}))}),[]),Object(h.jsx)("div",{id:"scoreboard",children:Object(h.jsx)("ol",{children:Object.values(n).sort((function(e,t){return t.score-e.score})).map((function(e){return Object(h.jsx)(w,{score:e.score||0,name:e.name,photoUrl:e.photoUrl},e.id)}))})})}function w(e){return Object(h.jsx)("li",{className:"player-list-item",children:Object(h.jsxs)("div",{className:"pli-container",children:[Object(h.jsxs)("div",{className:"pli-left",children:[Object(h.jsx)("img",{src:e.photoUrl}),Object(h.jsxs)("div",{className:"pli-stack",children:[Object(h.jsx)("div",{className:"pli-name",children:e.name}),Object(h.jsx)("div",{className:"pli-history",children:"\u2705 \u274c \u2705 \u2705 \u274c \u274c \u2705 \u274c"})]})]}),Object(h.jsx)("div",{className:"pli-right score",children:e.score})]})})}var S=function(e){var t,n=Object(r.useContext)(m),c=n.prompt;return n.setPrompt,Object(h.jsxs)("div",{className:"sidebar",children:[Object(h.jsx)("h1",{id:"sidebar-header",children:"Square Off!"}),Object(h.jsxs)("div",{id:"sidebar-content","data-controls-hidden":e.isPlaying,children:[Object(h.jsxs)("div",{id:"game-fact-container","data-display-none":!e.isPlaying,children:[Object(h.jsx)("div",{id:"timer",children:e.timeLeft}),Object(h.jsxs)("div",{id:"task-description",children:["Find ",(t=c,t?["a","b","c","d","e","f","g","h"][t[0]-1]+t[1]:"")]}),Object(h.jsx)(g,{})]}),Object(h.jsx)("div",{"data-display-none":e.isPlaying})]}),Object(h.jsx)("div",{id:"controls-container","data-display-none":e.isPlaying,children:Object(h.jsxs)("div",{id:"controls-inner-container",children:[Object(h.jsxs)("div",{children:["Round Length: ",e.gameDuration]}),Object(h.jsx)("input",{type:"range",min:"10",max:"60",className:"slider",id:"myRange",value:e.gameDuration,step:"5",onChange:function(t){return e.setGameDuration(Number(t.target.value))}}),Object(h.jsx)("div",{children:"Perspective:"}),Object(h.jsx)("input",{type:"checkbox",name:"perspective",checked:!0,id:"perspective"}),Object(h.jsx)("label",{htmlFor:"perspective","data-display-none":e.isPlaying,children:"View as black"}),Object(h.jsx)("div",{id:"button-background-3d",children:Object(h.jsx)("button",{id:"start",className:"fun-orange-button",onClick:function(){return e.onStartClicked()},children:"Start!"})})]})})]})};var _=function(){var e,t=Object(r.useState)(!0),n=Object(l.a)(t,2),c=n[0],a=n[1],o=Object(r.useContext)(m).prompt;return Object(r.useEffect)((function(){a(!0),setTimeout((function(){a(!1)}),300)}),[o]),Object(h.jsxs)("div",{id:"prompt",className:c?"showing":"hiding",children:[" ",(e=o,e?["a","b","c","d","e","f","g","h"][e[0]-1]+e[1]:"")," "]})};function P(){var e=Object(r.useState)(0),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(r.useContext)(m),o=a.isPlaying,i=a.setIsPlaying,s=Object(r.useContext)(m),u=(s.prompt,s.setPrompt),p=Object(r.useState)(30),d=Object(l.a)(p,2),f=d[0],b=d[1];return Object(r.useEffect)((function(){v.onGameStart(j.socket,(function(){return i(!0)})),j.socket&&v.onPromptUpdate(j.socket,(function(e){u(e)})),j.socket&&v.onTimeLeftUpdate(j.socket,(function(e){c(e)})),v.onGameEnd(j.socket,(function(){i(!1)})),v.onGameWin(j.socket,(function(){return alert("you won")})),v.onGameLoss(j.socket,(function(){return alert("you lost")}))}),[]),Object(h.jsxs)("div",{id:"container",children:[Object(h.jsx)("div",{id:"game-container",children:Object(h.jsxs)("div",{id:"game",children:[Object(h.jsx)(y,{onSubmitAnswer:function(e){v.submitAnswer(j.socket,[e[0],e[1]])},perspective:"white"}),Object(h.jsx)(_,{})]})}),Object(h.jsx)(S,{timeLeft:n,isPlaying:o,onStartClicked:function(){return function(){var e={gameDuration:f,perspective:"white"};v.startGame(j.socket,e)}()},gameDuration:f,setGameDuration:function(e){return b(e)}})]})}var N=function(){window.open("https://square-off-backend.herokuapp.com/auth/google/","_self")};function C(){return Object(h.jsxs)("div",{className:"login account-panel",children:[Object(h.jsx)("h1",{className:"banner-header",children:"Welcome"}),Object(h.jsx)("h2",{children:"Log In"}),Object(h.jsx)("div",{id:"button-background-3d",children:Object(h.jsx)("button",{id:"login",className:"fun-orange-button",onClick:N,children:"Log In with Google!"})})]})}var G=n(57),M=n(2),I=n(56),U=n.n(I);var R=function(){var e=Object(r.useState)(!1),t=Object(l.a)(e,2),n=t[0],c=t[1],a=Object(r.useState)(!1),o=Object(l.a)(a,2),i=(o[0],o[1],Object(r.useState)(!1)),p=Object(l.a)(i,2),d=p[0],f=p[1],b=Object(r.useState)(null),v=Object(l.a)(b,2),x=v[0],k=v[1],y=Object(r.useState)(null),g=Object(l.a)(y,2),w=g[0],S=g[1],_=function(){var e=Object(u.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.connect("https://square-off-backend.herokuapp.com").catch((function(e){console.log("Error: ",e)}));case 2:e.sent;case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();Object(r.useEffect)((function(){_(),U.a.get("https://square-off-backend.herokuapp.com/getuser",{withCredentials:!0}).then((function(e){if(e.data){alert("successful getuser");var t={firstName:e.data.displayName,photoUrl:e.data.photos[0].value,id:Math.floor(200*Math.random()).toString()};S(t)}})).catch((function(e){return console.log(e)}))}),[]);var N={isInRoom:n,setInRoom:c,isPlaying:d,setIsPlaying:f,prompt:x,setPrompt:k,user:w,setUser:S};return Object(h.jsx)(m.Provider,{value:N,children:Object(h.jsx)("div",{className:"App",children:Object(h.jsx)(G.a,{children:Object(h.jsxs)(M.c,{children:[Object(h.jsx)(M.a,{path:"/login/",element:Object(h.jsx)(C,{})}),Object(h.jsx)(M.a,{path:"/play/",element:Object(h.jsxs)(h.Fragment,{children:[!n&&Object(h.jsx)(O,{})," ",n&&Object(h.jsx)(P,{})]})})]})})})})};o.a.render(Object(h.jsx)(c.a.StrictMode,{children:Object(h.jsx)(R,{})}),document.getElementById("root"))},64:function(e,t,n){}},[[113,1,2]]]);
//# sourceMappingURL=main.1be1600b.chunk.js.map